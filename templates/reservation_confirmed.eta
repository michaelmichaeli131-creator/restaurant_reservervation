<% layout("_layout", it) %>

<section class="confirm">
  <div class="hero">
    <div class="icon">âœ“</div>
    <h1 class="title">×”×–×× ×” ×××•×©×¨×ª</h1>
    <% if (it.restaurant && it.restaurant.name) { %>
      <p class="muted">×œ××¡×¢×“×” <strong><%= it.restaurant.name %></strong></p>
    <% } %>
  </div>

  <div class="grid">
    <!-- ×ª×§×¦×™×¨ -->
    <article class="card">
      <h2 class="h2">×ª×§×¦×™×¨</h2>
      <ul class="kv">
        <% if (it.reservation && (it.reservation.date || it.reservation.time)) { %>
          <li><span>×ª××¨×™×š ×•×©×¢×”</span><span><%= it.reservation.date || '' %><%~ it.reservation.time ? ' Â· ' + it.reservation.time : '' %></span></li>
        <% } %>
        <% if (it.reservation && (it.reservation.size || it.reservation.guests)) { %>
          <li><span>×¡×•×¢×“×™×</span><span><%= it.reservation.size || it.reservation.guests %></span></li>
        <% } %>
        <% if (it.reservation && (it.reservation.name || it.reservation.contactName)) { %>
          <li><span>×©× ×”××–××™×Ÿ/×”</span><span><%= it.reservation.name || it.reservation.contactName %></span></li>
        <% } %>
        <% if (it.reservation && it.reservation.notes) { %>
          <li class="notes"><span>×”×¢×¨×•×ª</span><span class="pre"><%= it.reservation.notes %></span></li>
        <% } %>
      </ul>

      <div class="actions">
        <% if (it.links && it.links.details) { %><a class="btn" href="<%= it.links.details %>">×¦×¤×™×™×” ×‘×¤×¨×˜×™ ×”×”×–×× ×”</a><% } %>
        <% if (it.links && it.links.cancel) { %>
          <form class="inline" method="post" action="<%= it.links.cancel %>" onsubmit="return confirm('×œ×‘×˜×œ ××ª ×”×”×–×× ×”?')">
            <button class="btn danger" type="submit">×‘×™×˜×•×œ</button>
          </form>
        <% } %>
      </div>
    </article>

    <!-- QR + ×™×•××Ÿ + × ×™×•×•×˜ -->
    <aside class="stack">
      <% if ((it.qr && it.qr.src) || (it.reservation && it.reservation.id)) { %>
      <article class="card">
        <h3 class="h3">×§×•×“ ×”×–×× ×”</h3>
        <div class="qr">
          <% if (it.qr && it.qr.src) { %>
            <img src="<%= it.qr.src %>" alt="QR ×œ×”×–×× ×”" width="160" height="160" />
          <% } else { %>
            <img src="/qr?text=<%= encodeURIComponent(String(it.reservation.id)) %>" alt="QR ×œ×”×–×× ×”" width="160" height="160" />
          <% } %>
        </div>
        <div class="muted small" dir="ltr">#<%= (it.reservation && it.reservation.id) || '' %></div>
      </article>
      <% } %>

      <% if (it.calendar && (it.calendar.ics || it.calendar.google || it.calendar.apple)) { %>
      <article class="card">
        <h3 class="h3">×”×•×¡×£ ×œ×™×•××Ÿ</h3>
        <div class="row chips">
          <% if (it.calendar.ics) { %><a class="chip" href="<%= it.calendar.ics %>">ICS</a><% } %>
          <% if (it.calendar.google) { %><a class="chip" href="<%= it.calendar.google %>" target="_blank" rel="noopener">Google</a><% } %>
          <% if (it.calendar.apple) { %><a class="chip" href="<%= it.calendar.apple %>">Apple</a><% } %>
        </div>
      </article>
      <% } %>

      <% if (it.restaurant && (it.restaurant.phone || it.restaurant.map || it.restaurant.website)) { %>
      <article class="card">
        <h3 class="h3">××™×š ××’×™×¢×™×?</h3>
        <ul class="list">
          <% if (it.restaurant.phone) { %><li><a href="tel:<%= it.restaurant.phone %>">ğŸ“ <span dir="ltr"><%= it.restaurant.phone %></span></a></li><% } %>
          <% if (it.restaurant.website) { %><li><a href="<%= it.restaurant.website %>" target="_blank" rel="noopener">ğŸŒ ××ª×¨ ×”××¡×¢×“×”</a></li><% } %>
          <% if (it.restaurant.map) { %><li><a href="<%= it.restaurant.map %>" target="_blank" rel="noopener">ğŸ—ºï¸ × ×•×•×˜ ×¢× ××¤×•×ª</a></li><% } %>
        </ul>
      </article>
      <% } %>
    </aside>
  </div>

  <!-- CTA ×œ×—×–×¨×” ×œ××¡×¢×“×” / ×”××©×š ×’×œ×™×©×” -->
  <div class="cta">
    <% if (it.links && it.links.restaurant) { %>
      <a class="btn lg" href="<%= it.links.restaurant %>">×—×–×¨×” ×œ×“×£ ×”××¡×¢×“×”</a>
    <% } else { %>
      <a class="btn lg" href="/">×—×–×¨×” ×œ××ª×¨</a>
    <% } %>
  </div>
</section>

<style>
  :root{--bd:#222834;--panel:#12151b;--panel2:#161a21;--ink:#e6e9ef;--ink-dim:#98a2b3}

  .confirm{max-width:900px;margin:0 auto;display:grid;gap:14px}
  .hero{display:grid;justify-items:center;gap:8px;margin-top:6px}
  .icon{inline-size:52px;block-size:52px;border-radius:50%;display:grid;place-items:center;background:rgba(34,197,94,.12);border:1px solid rgba(34,197,94,.35);font-weight:800}
  .title{margin:0}
  .muted{color:var(--ink-dim)}

  .grid{display:grid;grid-template-columns:2fr 1fr;gap:12px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}

  .card{background:linear-gradient(180deg, rgba(22,26,33,.9), rgba(16,19,25,.94));border:1px solid var(--bd);border-radius:14px;padding:12px}
  .h2{margin:0 0 8px;font-size:18px}
  .h3{margin:0 0 8px;font-size:16px}

  .kv{list-style:none;margin:0;padding:0;display:grid;gap:8px}
  .kv li{display:grid;grid-template-columns:140px 1fr;gap:10px}
  .kv li>span:first-child{color:var(--ink-dim);font-size:12px}
  .pre{white-space:pre-wrap}

  .actions{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
  .btn{display:inline-flex;align-items:center;gap:6px;padding:8px 12px;border-radius:10px;border:1px solid #2a3040;background:transparent;color:var(--ink);font-weight:600;text-decoration:none}
  .btn:hover{transform:translateY(-1px)}
  .btn.danger{border-color:rgba(239,68,68,.45);color:#fecaca}
  .btn.lg{padding:10px 16px;border-radius:12px}

  .stack{display:grid;gap:12px}
  .qr{display:flex;justify-content:center;margin:6px 0}

  .list{list-style:none;margin:0;padding:0;display:grid;gap:6px}
  .list a{color:var(--ink);text-decoration:none}
  .list a:hover{text-decoration:underline}

  .chips{gap:6px}
  .chip{display:inline-flex;align-items:center;padding:6px 10px;border-radius:999px;border:1px solid #2a3040;text-decoration:none;color:var(--ink)}
  .chip:hover{transform:translateY(-1px)}

  .cta{display:grid;justify-items:center;margin-top:4px}
</style>
