import{r as w,j as e,R as x,t as b,c as he}from"./floor-index.js";const j="/floor_assets/",be=(r,l=1)=>{const N=Number(r);return Number.isFinite(N)?Math.max(.5,Math.min(1.6,N)):l},ve=r=>{const l=Number(r);return Number.isFinite(l)?Math.round(l/45)*45:0},ge=r=>{if(!r||r.startsWith("#"))return"parquet_blue";const l=r;return l==="parquet_blue"||l==="parquet_brown"||l==="slate_dark"||l==="navy_carpet"||l==="teal_terrazzo"?l:"parquet_blue"};function xe(r){return{parquet_blue:{bg:`url(${j}floor_parquet_blue.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},parquet_brown:{bg:`url(${j}floor_parquet_brown.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},slate_dark:{bg:`url(${j}floor_slate_dark.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},navy_carpet:{bg:`url(${j}floor_navy_carpet.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},teal_terrazzo:{bg:`url(${j}floor_teal_terrazzo.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"}}[r]}function Ne(r,l){const N=String(r||"square").toLowerCase(),_=Number(l||0);return N==="round"?`${j}${_>=9?"round_table_10.svg":"round_table4.svg"}`:N==="booth"?`${j}${_>=6?"large_booth.svg":"booth4.svg"}`:N==="rect"?`${j}${_>=10?"square_table10.svg":_>=6?"square_table6.svg":_>=4?"square_table4.svg":"square_table2.svg"}`:`${j}${_>=10?"square_table10.svg":_>=6?"square_table6.svg":_>=4?"square_table4.svg":"square_table2.svg"}`}function we(r,l){const N=String(r||"").toLowerCase();return N==="door"?`${j}door.svg`:N==="wall"?`${j}wall.svg`:N==="divider"?`${j}divider.svg`:N==="chair"?`${j}chair.svg`:N==="bar"?`${j}bar.svg`:N==="plant"?`${j}plant.svg`:l?`${j}${l}.svg`:`${j}divider.svg`}function je({layout:r,mode:l,onTableClick:N,selectedTableId:_,selectedTableIds:ee}){const T=w.useRef(null),O=w.useRef(null),[R,ae]=w.useState(1),[E,B]=w.useState({x:0,y:0}),[G,L]=w.useState(!1),[U,z]=w.useState(!1),A=w.useRef(null),S=60,te=w.useMemo(()=>ge(r.floorColor),[r==null?void 0:r.id]),Z=w.useMemo(()=>xe(te),[te]),q=w.useMemo(()=>{const t=Array.isArray(ee)?ee:[];return new Set(t.map(s=>String(s)))},[Array.isArray(ee)?ee.join("|"):""]),K=w.useMemo(()=>{const t=Math.max(0,Number(r.gridRows??0)),s=Math.max(0,Number(r.gridCols??0)),i=(u,d,p)=>Math.max(d,Math.min(p,u));if(t<=0||s<=0)return{minX:0,minY:0,maxX:0,maxY:0,rows:t,cols:s};let m=1/0,n=1/0,o=-1/0,a=-1/0,f=!1;const c=(u,d,p,C)=>{const X=i(Number(u??0),0,s-1),$=i(Number(d??0),0,t-1),k=i(Number(p??1),1,s),F=i(Number(C??1),1,t);m=Math.min(m,X),n=Math.min(n,$),o=Math.max(o,X+k-1),a=Math.max(a,$+F-1),f=!0},M=Array.isArray(r.tables)?r.tables:[],v=Array.isArray(r.objects)?r.objects:[];for(const u of M)c(u.gridX??u.x,u.gridY??u.y,u.spanX,u.spanY);for(const u of v)c(u.gridX??u.x,u.gridY??u.y,u.spanX,u.spanY);return f?(m=i(m-1,0,s-1),n=i(n-1,0,t-1),o=i(o+1,0,s-1),a=i(a+1,0,t-1)):(m=0,n=0,o=s-1,a=t-1),{minX:m,minY:n,maxX:o,maxY:a,rows:t,cols:s}},[r==null?void 0:r.id,r==null?void 0:r.gridRows,r==null?void 0:r.gridCols,r==null?void 0:r.tables,r==null?void 0:r.objects]),I=w.useRef(R);w.useEffect(()=>{I.current=R},[R]),w.useEffect(()=>{const t=i=>{i.code==="Space"&&L(!0)},s=i=>{i.code==="Space"&&(L(!1),z(!1))};return window.addEventListener("keydown",t),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",s)}},[]);const Y=t=>Math.max(l==="view"?.01:.4,Math.min(2.5,t)),P=()=>{if(!T.current||!O.current)return;const t=T.current,s=O.current,i=getComputedStyle(t),m=parseFloat(i.paddingLeft||"0")||0,n=parseFloat(i.paddingRight||"0")||0,o=parseFloat(i.paddingTop||"0")||0,a=parseFloat(i.paddingBottom||"0")||0,f=getComputedStyle(s),c=parseFloat(f.marginLeft||"0")||0,M=parseFloat(f.marginTop||"0")||0,v=12,u=Math.max(1,t.clientWidth-m-n-v*2),d=Math.max(1,t.clientHeight-o-a-v*2),{minX:p,minY:C,maxX:X,maxY:$}=K,k=Math.max(1,(X-p+1)*S),F=Math.max(1,($-C+1)*S),ce=l==="view"?1:1.2,H=Y(Math.min(u/k,d/F,ce));ae(H);const de=Math.round(m+v+(u-k*H)/2-p*S*H-c),W=Math.round(o+v+(d-F*H)/2-C*S*H-M);B({x:de,y:W}),t.scrollLeft=0,t.scrollTop=0};w.useEffect(()=>{requestAnimationFrame(P)},[r==null?void 0:r.id,K.minX,K.minY,K.maxX,K.maxY]),w.useEffect(()=>{if(!T.current)return;let t=0;const s=new ResizeObserver(()=>{cancelAnimationFrame(t),t=requestAnimationFrame(P)});return s.observe(T.current),()=>{cancelAnimationFrame(t),s.disconnect()}},[r==null?void 0:r.id]);const h=(t,s,i,m=I.current)=>{if(!T.current)return;const n=T.current.getBoundingClientRect(),o=s-n.left,a=i-n.top;B(f=>{const c=t/(m||1);return{x:Math.round(o-(o-f.x)*c),y:Math.round(a-(a-f.y)*c)}}),ae(t)};w.useEffect(()=>{const t=T.current;if(!t)return;const s=i=>{if(!(i.ctrlKey||i.metaKey))return;i.preventDefault(),i.stopPropagation();const m=Y(I.current*(i.deltaY>0?.9:1.1));h(m,i.clientX,i.clientY,I.current)};return t.addEventListener("wheel",s,{passive:!1}),()=>t.removeEventListener("wheel",s)},[l]);const ie=t=>{const s=t.target;if(l==="view"){if(t.button!==0||s!=null&&s.closest(".fe-canvas-controls, button, a, input, textarea, select"))return;t.preventDefault(),A.current={moved:!1};const c={x:t.clientX,y:t.clientY},M={...E};let v=!1;const u=p=>{const C=p.clientX-c.x,X=p.clientY-c.y,$=Math.abs(C)+Math.abs(X);!v&&$>4&&(v=!0,A.current&&(A.current.moved=!0),z(!0)),v&&B({x:M.x+C,y:M.y+X})},d=()=>{v&&z(!1),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",d),A.current&&!A.current.moved&&(A.current=null)};window.addEventListener("mousemove",u),window.addEventListener("mouseup",d);return}const i=t.button===1,m=G&&t.button===0;if(!i&&!m)return;t.preventDefault(),z(!0);const n={x:t.clientX,y:t.clientY},o={...E},a=c=>{B({x:o.x+(c.clientX-n.x),y:o.y+(c.clientY-n.y)})},f=()=>{z(!1),window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",f)};window.addEventListener("mousemove",a),window.addEventListener("mouseup",f)},y=w.useRef(null),g=t=>{if(l!=="view"||t.touches.length!==1)return;const s=t.touches[0],i=t.target;i!=null&&i.closest(".table, .floor-object, .fe-canvas-controls, button, a, input, textarea, select")||(z(!0),y.current={startX:s.clientX,startY:s.clientY,panX:E.x,panY:E.y,active:!0})},D=t=>{if(l!=="view")return;const s=y.current;if(!s||!s.active||t.touches.length!==1)return;const i=t.touches[0];B({x:s.panX+(i.clientX-s.startX),y:s.panY+(i.clientY-s.startY)})},se=()=>{l==="view"&&(y.current=null,z(!1))},V=t=>Math.max(1,Number(t)||1)*S,ne=t=>{const s=(t||"").toLowerCase();return s.includes("occup")||s==="busy"||s==="taken"?"occupied":s.includes("reserv")||s.includes("book")?"reserved":s.includes("dirty")||s.includes("need")||s.includes("clean")?"dirty":"empty"},J=w.useMemo(()=>{const t=new Map;return(Array.isArray(r.tableStatuses)?r.tableStatuses:[]).forEach(s=>{const i=s&&s.tableId?String(s.tableId):"";i&&t.set(i,{status:ne(String(s.status||"empty")),guestName:s.guestName??null,guestCount:s.guestCount??null,orderId:s.orderId??null})}),t},[r]),oe=w.useMemo(()=>{const t=new Map;return(Array.isArray(r.tableStatuses)?r.tableStatuses:[]).forEach(s=>{const i=Number(s&&(s.tableNumber??0));!Number.isFinite(i)||i<=0||t.set(i,{status:ne(String(s.status||"empty")),guestName:s.guestName??null,guestCount:s.guestCount??null,orderId:s.orderId??null})}),t},[r]),le=t=>{const s=t.id?J.get(String(t.id)):void 0;if(s)return s;const i=Number(t.tableNumber??0);if(Number.isFinite(i)&&i>0){const m=oe.get(i);if(m)return m}return{status:"empty"}};return e.jsxs("div",{className:`editor-canvas ${U?"is-panning":""}`,ref:T,onMouseDown:ie,onTouchStart:g,onTouchMove:D,onTouchEnd:se,style:{position:"relative",touchAction:"none",overscrollBehavior:"contain"},children:[e.jsxs("div",{className:"fe-canvas-controls",children:[e.jsx("button",{className:"btn-icon-small",onClick:()=>{var s;const t=(s=T.current)==null?void 0:s.getBoundingClientRect();h(Y(R*1.1),((t==null?void 0:t.left)||0)+40,((t==null?void 0:t.top)||0)+40)},title:"Zoom in",children:"＋"}),e.jsx("button",{className:"btn-icon-small",onClick:()=>{var s;const t=(s=T.current)==null?void 0:s.getBoundingClientRect();h(Y(R*.9),((t==null?void 0:t.left)||0)+40,((t==null?void 0:t.top)||0)+40)},title:"Zoom out",children:"－"}),e.jsx("button",{className:"btn-icon-small",onClick:P,title:"Fit to screen",children:"⤢"}),e.jsxs("div",{className:"fe-zoom-readout",children:[Math.round(R*100),"%"]}),e.jsx("div",{className:"fe-hint",children:G?"Pan: drag":"Tip: hold Space to pan, Ctrl+wheel to zoom"})]}),e.jsx("div",{className:"fe-grid",ref:O,onClickCapture:t=>{var s;l==="view"&&(s=A.current)!=null&&s.moved&&(t.preventDefault(),t.stopPropagation(),A.current=null)},style:{direction:"ltr",gridTemplateColumns:`repeat(${r.gridCols}, ${S}px)`,gridTemplateRows:`repeat(${r.gridRows}, ${S}px)`,transform:`translate(${E.x}px, ${E.y}px) scale(${R})`,transformOrigin:"0 0","--cell":`${S}px`,"--floor-bg":Z.bg,"--floor-bg-size":Z.size,"--floor-bg-repeat":Z.repeat,"--floor-bg-position":Z.pos},children:Array.from({length:r.gridRows*r.gridCols}).map((t,s)=>{var u;const i=Math.floor(s/r.gridCols),m=s%r.gridCols,n=r.tables.find(d=>m>=d.gridX&&m<d.gridX+(d.spanX||1)&&i>=d.gridY&&i<d.gridY+(d.spanY||1)),a=(r.objects??[]).find(d=>m>=d.gridX&&m<d.gridX+(d.spanX||1)&&i>=d.gridY&&i<d.gridY+(d.spanY||1)),f=!!n&&n.gridX===m&&n.gridY===i,c=!!a&&a.gridX===m&&a.gridY===i,M=i*r.gridCols+m,v=(((u=r.gridMask)==null?void 0:u[M])??1)===1;return e.jsxs("div",{className:`fe-grid-cell ${v?"active":"inactive"}`,children:[c&&a&&e.jsxs("div",{className:`floor-object type-${a.type}`,style:{width:`${V(a.spanX)}px`,height:`${V(a.spanY)}px`,transform:`rotate(${ve(a.rotationDeg??a.rotation??0)}deg)`,cursor:l==="view"?"default":"grab"},children:[e.jsx("img",{className:`fe-asset fe-asset--${(a.assetFile||"").replace(/[^a-z0-9]+/gi,"_").toLowerCase()}`,style:{transform:`scale(${be(a.scale,1)})`},src:a.assetFile?`${j}${a.assetFile}`:we(a.type,a.label),alt:""}),a.label&&e.jsx("div",{className:"obj-label",children:a.label})]}),f&&n&&(()=>{const d=le(n),p=String(d.status||"empty"),C=q.size>0?q.has(String(n.id)):_&&String(_)===String(n.id),X=l==="view",$=p==="occupied"?"תפוס":p==="reserved"?"שמור":p==="dirty"?"מלוכלך":"פנוי",k=d.guestCount!=null&&d.guestCount!==""?` · ${d.guestCount}`:"";return e.jsxs("div",{className:`table floor-table status-${p} ${String(n.shape||"square")} ${C?"is-selected":""}`,onClick:F=>N==null?void 0:N(n.id,{ctrlKey:F.ctrlKey,metaKey:F.metaKey,shiftKey:F.shiftKey}),style:{position:"absolute",top:0,left:0,width:`${V(n.spanX)}px`,height:`${V(n.spanY)}px`,cursor:l==="view"?"pointer":"default"},children:[e.jsx("div",{className:"fe-table-visual","data-asset":n.assetFile||"",children:e.jsx("img",{className:`fe-asset fe-asset--${(n.assetFile||"").replace(/[^a-z0-9]+/gi,"_").toLowerCase()}`,style:{transform:`rotate(${ve(n.rotationDeg??n.rotation??0)}deg) scale(${be(n.scale,1)})`},src:n.assetFile?`${j}${n.assetFile}`:Ne(n.shape,n.seats),alt:""})}),e.jsxs("div",{className:"fe-table-overlay",children:[e.jsx("div",{className:"table-label",children:n.name||(n.tableNumber!=null?`Table ${n.tableNumber}`:"Table")}),n.seats!=null&&e.jsxs("div",{className:"table-seats",children:[n.seats," seats"]})]}),X&&e.jsxs("div",{className:`sbv-status-pill is-${p}`,children:[e.jsx("span",{className:"sbv-dot"}),e.jsxs("span",{className:"sbv-status-text",children:[$,k]})]})]})})()]},s)})})]})}function Se(r){const l=(r||"").toLowerCase();return l==="occupied"||l==="busy"||l==="taken"?"occupied":l==="reserved"||l==="booked"?"reserved":l==="dirty"||l==="needs_cleaning"?"dirty":"empty"}function re(r){return b(`floor.status.${r}`,r)}function ye({restaurantId:r,mountMode:l="page"}){var m;const[N,_]=x.useState([]),[ee,T]=x.useState(null),[O,R]=x.useState(null),[ae,E]=x.useState(!0),[B,G]=x.useState(null),[L,U]=x.useState(null),[z,A]=x.useState([]),S=x.useRef(null),[te,Z]=x.useState([]),[q,K]=x.useState(null),I=typeof document<"u"?document.getElementById("sb-floor-root"):null,Y=String((I==null?void 0:I.getAttribute("data-click-mode"))||(I==null?void 0:I.getAttribute("data-mode"))||(l==="lobby"?"lobby":"page")).toLowerCase();x.useEffect(()=>{(async()=>{try{const n=await fetch(`/api/floor-sections/${r}`);if(!n.ok)return;const o=await n.json(),a=Array.isArray(o)?o:(o==null?void 0:o.sections)??[];a.sort((f,c)=>(f.displayOrder??0)-(c.displayOrder??0)),Z(a)}catch{}})()},[r]);const P=x.useCallback(async()=>{try{const n=await fetch(`/api/floor-layouts/${r}/active`,{headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}`);const o=await n.json(),a=o&&o.id?o:(o==null?void 0:o.activeLayout)??null;if(!a){_([]),T(null),R(null),G(b("host.no_floor_plan","No active floor plan")),E(!1);return}_([a]),T(a.id),R(f=>f??a.id),G(null),E(!1),A(f=>{const c=new Set((a.tables||[]).map(v=>String(v.id))),M=(f||[]).map(String).filter(v=>c.has(v));return U(v=>{const u=v?String(v):null;return u&&c.has(u)?u:M.length?String(M[0]):null}),S.current&&!c.has(String(S.current))&&(S.current=M.length?String(M[0]):null),M})}catch(n){G(b("host.err_load_map","Error loading floor map")+`: ${(n==null?void 0:n.message)??"unknown"}`),E(!1)}},[r]);x.useEffect(()=>{P();const n=setInterval(P,5e3);return()=>clearInterval(n)},[P]);const h=x.useMemo(()=>O?N.find(n=>n.id===O)??null:null,[N,O]),ie=x.useMemo(()=>h?q?{...h,tables:(h.tables||[]).filter(n=>n.sectionId===q)}:h:null,[h,q]),y=x.useMemo(()=>!h||!L?null:(h.tables||[]).find(n=>String(n.id)===String(L))??null,[h,L]),g=x.useMemo(()=>{if(!h||!y)return null;const n=h.tableStatuses;if(!Array.isArray(n))return null;const o=n.find(a=>String(a.tableId)===String(y.id));return o||(n.find(a=>a.tableNumber===y.number)??null)},[h,y]),D=x.useMemo(()=>Se(g==null?void 0:g.status),[g]),se=x.useMemo(()=>Y==="host"?z:L?[L]:[],[Y,z,L]);x.useEffect(()=>{if(typeof window>"u")return;const n=h,o=new Map;((n==null?void 0:n.tables)||[]).forEach(c=>{const M=String(c.id),v=Number(c.tableNumber??c.number??c.tableNum??0);Number.isFinite(v)&&v>0&&o.set(M,v)});const a=(se||[]).map(String).filter(Boolean),f=a.map(c=>o.get(String(c))).filter(c=>Number.isFinite(Number(c))&&Number(c)>0).map(c=>Number(c));window.dispatchEvent(new CustomEvent("sb-floor-selection",{detail:{tableIds:a,tableNumbers:f}}))},[h==null?void 0:h.id,(m=h==null?void 0:h.tables)==null?void 0:m.length,se.join("|")]);const V=(n,o)=>{const a=String(n);if(Y!=="host"){U(a),A([a]),S.current=a;return}const f=!!(o!=null&&o.ctrlKey)||!!(o!=null&&o.metaKey),c=!!(o!=null&&o.shiftKey);A(M=>{const v=new Set((M||[]).map(String)),u=(h==null?void 0:h.tables)||[],d=new Map;u.forEach($=>{const k=Number($.tableNumber??$.number??0);Number.isFinite(k)&&k>0&&d.set(String($.id),k)});let p;if(c&&S.current&&d.size>0){const $=String(S.current),k=d.get($),F=d.get(a);if(k!=null&&F!=null){const ce=Math.min(k,F),H=Math.max(k,F),de=u.filter(W=>{const ue=d.get(String(W.id));return ue!=null&&ue>=ce&&ue<=H}).map(W=>String(W.id));p=f?new Set(v):new Set,de.forEach(W=>p.add(W))}else p=f?new Set(v):new Set,p.add(a)}else f?(p=new Set(v),p.has(a)?p.delete(a):p.add(a)):p=new Set([a]);const C=Array.from(p);C.sort(($,k)=>(d.get($)??0)-(d.get(k)??0));const X=p.has(a)?a:C[0]??null;return U(X),c||(S.current=a),!S.current&&C[0]&&(S.current=String(C[0])),C})},ne=()=>{U(null),Y==="host"&&A([])},J=async n=>{const o=y==null?void 0:y.id;if(o)try{const a=await fetch(`/api/tables/${r}/${o}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:n})});if(!a.ok){const f=await a.text().catch(()=>"");throw new Error(f||`HTTP ${a.status}`)}await P()}catch(a){console.error("Failed to update table status:",a)}},oe=async()=>{await J("dirty")},le=async()=>{await J("empty")},t=async()=>{await J("reserved")},s=async()=>{await J("empty")},i=`floor-editor sb-floor-view ${l==="lobby"?"is-embed":""}`;return ae?e.jsx("div",{className:i,children:e.jsx("div",{className:"sbv-loading",children:b("floor.loading","Loading floor plan...")})}):B||!h?e.jsx("div",{className:i,children:e.jsxs("div",{className:"sbv-error",children:[e.jsx("div",{className:"sbv-error-title",children:b("host.err_load_map","Cannot load floor map")}),e.jsx("div",{className:"sbv-error-sub",children:B??b("host.err_load_map","Error loading floor map")}),e.jsx("button",{className:"sbv-retry",onClick:P,children:b("common.btn_refresh","Retry")})]})}):e.jsx("div",{className:i,children:e.jsxs("div",{className:"sbv-shell",children:[e.jsxs("div",{className:"sbv-left",children:[e.jsxs("div",{className:"layout-tabs-bar sbv-view-topbar",children:[e.jsxs("div",{className:"sbv-topbar-left",children:[e.jsx("div",{className:"sbv-topbar-title",children:b("host.floor_map_title","Restaurant Map (Live)")}),e.jsx("div",{className:"sbv-topbar-sub",children:b("floor.hints.controls","Drag to pan, Ctrl+wheel to zoom")})]}),e.jsxs("div",{className:"sbv-legend","aria-label":"Legend",children:[e.jsxs("span",{className:"sbv-pill is-empty",children:[e.jsx("span",{className:"sbv-dot"})," ",re("empty")]}),e.jsxs("span",{className:"sbv-pill is-occupied",children:[e.jsx("span",{className:"sbv-dot"})," ",re("occupied")]}),e.jsxs("span",{className:"sbv-pill is-reserved",children:[e.jsx("span",{className:"sbv-dot"})," ",re("reserved")]}),e.jsxs("span",{className:"sbv-pill is-dirty",children:[e.jsx("span",{className:"sbv-dot"})," ",re("dirty")]})]}),te.length>1&&e.jsxs("div",{className:"sbv-section-tabs",role:"tablist","aria-label":b("floor.sections.title","Sections"),children:[e.jsx("button",{className:`sbv-section-tab ${q===null?"is-active":""}`,onClick:()=>K(null),role:"tab","aria-selected":q===null,children:b("common.all","All")}),te.map(n=>e.jsx("button",{className:`sbv-section-tab ${q===n.id?"is-active":""}`,onClick:()=>K(n.id),role:"tab","aria-selected":q===n.id,children:n.name},n.id))]})]}),e.jsx("div",{className:"editor-content sbv-editor-content",children:e.jsx(je,{layout:ie,selectedTableId:L,selectedTableIds:se,onTableClick:V,mode:"view"})})]}),e.jsx("aside",{className:`sbv-right ${l==="lobby"&&L?"open":""}`,"aria-label":b("host.table_details","Table details"),children:L?e.jsxs("div",{className:"sbv-right-panel",role:"dialog","aria-modal":"false",children:[e.jsxs("div",{className:"sbv-drawer-header",children:[e.jsx("div",{className:"sbv-drawer-title",children:b("host.table_details","Table Details")}),e.jsx("button",{className:"sbv-close",onClick:ne,"aria-label":b("common.btn_close","Close"),children:"✕"})]}),e.jsxs("div",{className:"sbv-drawer-body",children:[e.jsxs("div",{className:"sbv-table-number",children:[b("host.table_label","Table")," ",(y==null?void 0:y.number)??"—"]}),e.jsxs("div",{className:`sbv-status-row is-${D}`,children:[e.jsx("span",{className:"sbv-status-dot"}),e.jsx("span",{className:"sbv-status-label",children:b("host.table_status_label","Table Status")}),e.jsx("span",{className:"sbv-status-value",children:re(D)})]}),e.jsxs("div",{className:"sbv-kv",children:[e.jsxs("div",{className:"sbv-kv-row",children:[e.jsx("div",{className:"sbv-kv-key",children:b("host.guest_name","Guest Name")}),e.jsx("div",{className:"sbv-kv-val",children:(g==null?void 0:g.guestName)??"—"})]}),e.jsxs("div",{className:"sbv-kv-row",children:[e.jsx("div",{className:"sbv-kv-key",children:b("host.num_guests","Guests")}),e.jsx("div",{className:"sbv-kv-val",children:(g==null?void 0:g.guestCount)!=null?String(g.guestCount):"—"})]}),e.jsxs("div",{className:"sbv-kv-row",children:[e.jsx("div",{className:"sbv-kv-key",children:b("host.reservation_time","Reservation Time")}),e.jsx("div",{className:"sbv-kv-val",children:(g==null?void 0:g.reservationTime)??"—"})]}),e.jsxs("div",{className:"sbv-kv-row",children:[e.jsx("div",{className:"sbv-kv-key",children:b("pos.waiter.items_label","Items")}),e.jsx("div",{className:"sbv-kv-val",children:(g==null?void 0:g.itemsCount)??"—"})]}),e.jsxs("div",{className:"sbv-kv-row",children:[e.jsx("div",{className:"sbv-kv-key",children:b("pos.waiter.subtotal","Subtotal")}),e.jsx("div",{className:"sbv-kv-val",children:(g==null?void 0:g.subtotal)??"—"})]})]})]}),e.jsxs("div",{className:"sbv-drawer-footer",children:[Y==="lobby"||Y==="waiter"?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"sbv-secondary-btn",onClick:oe,disabled:D==="dirty",children:b("floor.mark_dirty","Mark Dirty")}),e.jsx("button",{className:"sbv-success-btn",onClick:le,disabled:D!=="dirty",children:b("floor.mark_clean","Mark Clean")})]}):null,Y==="host"?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"sbv-primary-btn",onClick:t,disabled:D==="reserved",children:b("floor.mark_reserved","Mark Reserved")}),e.jsx("button",{className:"sbv-secondary-btn",onClick:s,disabled:D==="empty",children:b("floor.mark_empty","Mark Empty")})]}):null,D==="occupied"&&(g!=null&&g.orderId)&&(y!=null&&y.number)?e.jsx("a",{className:"sbv-primary-btn",href:`/waiter/${r}/${y.number}`,children:b("pos.waiter.btn_open_order","Open Order")}):null,e.jsx("button",{className:"sbv-secondary-btn",onClick:ne,children:b("common.btn_close","Close")})]})]}):e.jsxs("div",{className:"sbv-right-empty",children:[e.jsx("div",{className:"sbv-right-empty-title",children:b("host.table_details","Table Details")}),e.jsx("div",{className:"sbv-right-empty-sub",children:b("host.floor_map_help","Select a table on the map to view details.")})]})})]})})}const Q=document.getElementById("sb-floor-root");if(!Q)throw new Error("Missing #sb-floor-root");const fe=Q.getAttribute("data-rid")||Q.getAttribute("data-restaurant-id")||"",me=Q.getAttribute("data-click-mode")||Q.getAttribute("data-mode")||"page",pe=me==="lobby"||me==="host"?"lobby":"page";console.info("[FloorView] mount",{rid:fe,mountMode:pe,clickMode:me});he.createRoot(Q).render(e.jsx(x.StrictMode,{children:e.jsx(ye,{restaurantId:fe,mountMode:pe})}));
