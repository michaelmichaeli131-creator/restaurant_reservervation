import{r as f,j as t,R as x,t as c,c as pe}from"./floor-index.js";const h="/floor_assets/",le=(r,i=1)=>{const v=Number(r);return Number.isFinite(v)?Math.max(.5,Math.min(1.6,v)):i},ce=r=>{const i=Number(r);return Number.isFinite(i)?Math.round(i/45)*45:0},fe=r=>{if(!r||r.startsWith("#"))return"parquet_blue";const i=r;return i==="parquet_blue"||i==="parquet_brown"||i==="slate_dark"||i==="navy_carpet"||i==="teal_terrazzo"?i:"parquet_blue"};function he(r){return{parquet_blue:{bg:`url(${h}floor_parquet_blue.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},parquet_brown:{bg:`url(${h}floor_parquet_brown.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},slate_dark:{bg:`url(${h}floor_slate_dark.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},navy_carpet:{bg:`url(${h}floor_navy_carpet.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"},teal_terrazzo:{bg:`url(${h}floor_teal_terrazzo.svg)`,size:"240px 240px",repeat:"repeat",pos:"center"}}[r]}function ge(r,i){const v=String(r||"square").toLowerCase(),j=Number(i||0);return v==="round"?`${h}${j>=9?"round_table_10.svg":"round_table4.svg"}`:v==="booth"?`${h}${j>=6?"large_booth.svg":"booth4.svg"}`:v==="rect"?`${h}${j>=10?"square_table10.svg":j>=6?"square_table6.svg":j>=4?"square_table4.svg":"square_table2.svg"}`:`${h}${j>=10?"square_table10.svg":j>=6?"square_table6.svg":j>=4?"square_table4.svg":"square_table2.svg"}`}function xe(r,i){const v=String(r||"").toLowerCase();return v==="door"?`${h}door.svg`:v==="wall"?`${h}wall.svg`:v==="divider"?`${h}divider.svg`:v==="chair"?`${h}chair.svg`:v==="bar"?`${h}bar.svg`:v==="plant"?`${h}plant.svg`:i?`${h}${i}.svg`:`${h}divider.svg`}function Ne({layout:r,mode:i,onTableClick:v,selectedTableId:j}){const k=f.useRef(null),O=f.useRef(null),[_,W]=f.useState(1),[I,E]=f.useState({x:0,y:0}),[G,H]=f.useState(!1),[M,S]=f.useState(!1),L=f.useRef(null),$=60,A=f.useMemo(()=>fe(r.floorColor),[r==null?void 0:r.id]),P=f.useMemo(()=>he(A),[A]),C=f.useMemo(()=>{const e=Math.max(0,Number(r.gridRows??0)),s=Math.max(0,Number(r.gridCols??0)),n=(u,m,X)=>Math.max(m,Math.min(X,u));if(e<=0||s<=0)return{minX:0,minY:0,maxX:0,maxY:0,rows:e,cols:s};let o=1/0,a=1/0,g=-1/0,l=-1/0,w=!1;const N=(u,m,X,R)=>{const B=n(Number(u??0),0,s-1),K=n(Number(m??0),0,e-1),te=n(Number(X??1),1,s),ne=n(Number(R??1),1,e);o=Math.min(o,B),a=Math.min(a,K),g=Math.max(g,B+te-1),l=Math.max(l,K+ne-1),w=!0},q=Array.isArray(r.tables)?r.tables:[],y=Array.isArray(r.objects)?r.objects:[];for(const u of q)N(u.gridX??u.x,u.gridY??u.y,u.spanX,u.spanY);for(const u of y)N(u.gridX??u.x,u.gridY??u.y,u.spanX,u.spanY);return w?(o=n(o-1,0,s-1),a=n(a-1,0,e-1),g=n(g+1,0,s-1),l=n(l+1,0,e-1)):(o=0,a=0,g=s-1,l=e-1),{minX:o,minY:a,maxX:g,maxY:l,rows:e,cols:s}},[r==null?void 0:r.id,r==null?void 0:r.gridRows,r==null?void 0:r.gridCols,r==null?void 0:r.tables,r==null?void 0:r.objects]),z=f.useRef(_);f.useEffect(()=>{z.current=_},[_]),f.useEffect(()=>{const e=n=>{n.code==="Space"&&H(!0)},s=n=>{n.code==="Space"&&(H(!1),S(!1))};return window.addEventListener("keydown",e),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",s)}},[]);const T=e=>Math.max(i==="view"?.01:.4,Math.min(2.5,e)),p=()=>{if(!k.current||!O.current)return;const e=k.current,s=O.current,n=getComputedStyle(e),o=parseFloat(n.paddingLeft||"0")||0,a=parseFloat(n.paddingRight||"0")||0,g=parseFloat(n.paddingTop||"0")||0,l=parseFloat(n.paddingBottom||"0")||0,w=getComputedStyle(s),N=parseFloat(w.marginLeft||"0")||0,q=parseFloat(w.marginTop||"0")||0,y=12,u=Math.max(1,e.clientWidth-o-a-y*2),m=Math.max(1,e.clientHeight-g-l-y*2),{minX:X,minY:R,maxX:B,maxY:K}=C,te=Math.max(1,(B-X+1)*$),ne=Math.max(1,(K-R+1)*$),me=i==="view"?1:1.2,V=T(Math.min(u/te,m/ne,me));W(V);const be=Math.round(o+y+(u-te*V)/2-X*$*V-N),ve=Math.round(g+y+(m-ne*V)/2-R*$*V-q);E({x:be,y:ve}),e.scrollLeft=0,e.scrollTop=0};f.useEffect(()=>{requestAnimationFrame(p)},[r==null?void 0:r.id,C.minX,C.minY,C.maxX,C.maxY]),f.useEffect(()=>{if(!k.current)return;let e=0;const s=new ResizeObserver(()=>{cancelAnimationFrame(e),e=requestAnimationFrame(p)});return s.observe(k.current),()=>{cancelAnimationFrame(e),s.disconnect()}},[r==null?void 0:r.id]);const Z=(e,s,n,o=z.current)=>{if(!k.current)return;const a=k.current.getBoundingClientRect(),g=s-a.left,l=n-a.top;E(w=>{const N=e/(o||1);return{x:Math.round(g-(g-w.x)*N),y:Math.round(l-(l-w.y)*N)}}),W(e)};f.useEffect(()=>{const e=k.current;if(!e)return;const s=n=>{if(!(n.ctrlKey||n.metaKey))return;n.preventDefault(),n.stopPropagation();const o=T(z.current*(n.deltaY>0?.9:1.1));Z(o,n.clientX,n.clientY,z.current)};return e.addEventListener("wheel",s,{passive:!1}),()=>e.removeEventListener("wheel",s)},[i]);const b=e=>{const s=e.target;if(i==="view"){if(e.button!==0||s!=null&&s.closest(".fe-canvas-controls, button, a, input, textarea, select"))return;e.preventDefault(),L.current={moved:!1};const N={x:e.clientX,y:e.clientY},q={...I};let y=!1;const u=X=>{const R=X.clientX-N.x,B=X.clientY-N.y,K=Math.abs(R)+Math.abs(B);!y&&K>4&&(y=!0,L.current&&(L.current.moved=!0),S(!0)),y&&E({x:q.x+R,y:q.y+B})},m=()=>{y&&S(!1),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",m),L.current&&!L.current.moved&&(L.current=null)};window.addEventListener("mousemove",u),window.addEventListener("mouseup",m);return}const n=e.button===1,o=G&&e.button===0;if(!n&&!o)return;e.preventDefault(),S(!0);const a={x:e.clientX,y:e.clientY},g={...I},l=N=>{E({x:g.x+(N.clientX-a.x),y:g.y+(N.clientY-a.y)})},w=()=>{S(!1),window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",w)};window.addEventListener("mousemove",l),window.addEventListener("mouseup",w)},d=f.useRef(null),F=e=>{if(i!=="view"||e.touches.length!==1)return;const s=e.touches[0],n=e.target;n!=null&&n.closest(".table, .floor-object, .fe-canvas-controls, button, a, input, textarea, select")||(S(!0),d.current={startX:s.clientX,startY:s.clientY,panX:I.x,panY:I.y,active:!0})},re=e=>{if(i!=="view")return;const s=d.current;if(!s||!s.active||e.touches.length!==1)return;const n=e.touches[0];E({x:s.panX+(n.clientX-s.startX),y:s.panY+(n.clientY-s.startY)})},Q=()=>{i==="view"&&(d.current=null,S(!1))},Y=e=>Math.max(1,Number(e)||1)*$,ee=e=>{const s=(e||"").toLowerCase();return s.includes("occup")||s==="busy"||s==="taken"?"occupied":s.includes("reserv")||s.includes("book")?"reserved":s.includes("dirty")||s.includes("need")||s.includes("clean")?"dirty":"empty"},ae=f.useMemo(()=>{const e=new Map;return(Array.isArray(r.tableStatuses)?r.tableStatuses:[]).forEach(s=>{const n=s&&s.tableId?String(s.tableId):"";n&&e.set(n,{status:ee(String(s.status||"empty")),guestName:s.guestName??null,guestCount:s.guestCount??null,orderId:s.orderId??null})}),e},[r]),oe=f.useMemo(()=>{const e=new Map;return(Array.isArray(r.tableStatuses)?r.tableStatuses:[]).forEach(s=>{const n=Number(s&&(s.tableNumber??0));!Number.isFinite(n)||n<=0||e.set(n,{status:ee(String(s.status||"empty")),guestName:s.guestName??null,guestCount:s.guestCount??null,orderId:s.orderId??null})}),e},[r]),se=e=>{const s=e.id?ae.get(String(e.id)):void 0;if(s)return s;const n=Number(e.tableNumber??0);if(Number.isFinite(n)&&n>0){const o=oe.get(n);if(o)return o}return{status:"empty"}},D=[];if(i==="view")for(const e of r.tables||[]){const s=se(e),n=String(s.status||"empty"),o=n==="occupied"?"תפוס":n==="reserved"?"שמור":n==="dirty"?"מלוכלך":"פנוי",a=s.guestCount!=null&&s.guestCount!==""?` · ${s.guestCount}`:"",g=Math.max(0,Number(e.gridX)||0)*$,l=Math.max(0,Number(e.gridY)||0)*$,w=Y(Number(e.spanX)||1),N=Y(Number(e.spanY)||1);D.push(t.jsx("div",{className:"sbv-status-anchor",style:{position:"absolute",left:g,top:l,width:w,height:N,pointerEvents:"none"},children:t.jsxs("div",{className:`sbv-status-pill is-${n}`,children:[t.jsx("span",{className:"sbv-dot"}),t.jsxs("span",{className:"sbv-status-text",children:[o,a]})]})},`sbv-status-${String(e.id??`${e.gridX}-${e.gridY}`)}`))}return t.jsxs("div",{className:`editor-canvas ${M?"is-panning":""}`,ref:k,onMouseDown:b,onTouchStart:F,onTouchMove:re,onTouchEnd:Q,style:{position:"relative",touchAction:"none",overscrollBehavior:"contain"},children:[t.jsxs("div",{className:"fe-canvas-controls",children:[t.jsx("button",{className:"btn-icon-small",onClick:()=>{var s;const e=(s=k.current)==null?void 0:s.getBoundingClientRect();Z(T(_*1.1),((e==null?void 0:e.left)||0)+40,((e==null?void 0:e.top)||0)+40)},title:"Zoom in",children:"＋"}),t.jsx("button",{className:"btn-icon-small",onClick:()=>{var s;const e=(s=k.current)==null?void 0:s.getBoundingClientRect();Z(T(_*.9),((e==null?void 0:e.left)||0)+40,((e==null?void 0:e.top)||0)+40)},title:"Zoom out",children:"－"}),t.jsx("button",{className:"btn-icon-small",onClick:p,title:"Fit to screen",children:"⤢"}),t.jsxs("div",{className:"fe-zoom-readout",children:[Math.round(_*100),"%"]}),t.jsx("div",{className:"fe-hint",children:G?"Pan: drag":"Tip: hold Space to pan, Ctrl+wheel to zoom"})]}),t.jsxs("div",{className:"fe-grid",ref:O,onClickCapture:e=>{var s;i==="view"&&(s=L.current)!=null&&s.moved&&(e.preventDefault(),e.stopPropagation(),L.current=null)},style:{direction:"ltr",gridTemplateColumns:`repeat(${r.gridCols}, ${$}px)`,gridTemplateRows:`repeat(${r.gridRows}, ${$}px)`,transform:`translate(${I.x}px, ${I.y}px) scale(${_})`,transformOrigin:"0 0","--cell":`${$}px`,"--floor-bg":P.bg,"--floor-bg-size":P.size,"--floor-bg-repeat":P.repeat,"--floor-bg-position":P.pos},children:[Array.from({length:r.gridRows*r.gridCols}).map((e,s)=>{var u;const n=Math.floor(s/r.gridCols),o=s%r.gridCols,a=r.tables.find(m=>o>=m.gridX&&o<m.gridX+(m.spanX||1)&&n>=m.gridY&&n<m.gridY+(m.spanY||1)),l=(r.objects??[]).find(m=>o>=m.gridX&&o<m.gridX+(m.spanX||1)&&n>=m.gridY&&n<m.gridY+(m.spanY||1)),w=!!a&&a.gridX===o&&a.gridY===n,N=!!l&&l.gridX===o&&l.gridY===n,q=n*r.gridCols+o,y=(((u=r.gridMask)==null?void 0:u[q])??1)===1;return t.jsxs("div",{className:`fe-grid-cell ${y?"active":"inactive"}`,children:[N&&l&&t.jsxs("div",{className:`floor-object type-${l.type}`,style:{width:`${Y(l.spanX)}px`,height:`${Y(l.spanY)}px`,transform:`rotate(${ce(l.rotationDeg??l.rotation??0)}deg)`,cursor:i==="view"?"default":"grab"},children:[t.jsx("img",{className:`fe-asset fe-asset--${(l.assetFile||"").replace(/[^a-z0-9]+/gi,"_").toLowerCase()}`,style:{transform:`scale(${le(l.scale,1)})`},src:l.assetFile?`${h}${l.assetFile}`:xe(l.type,l.label),alt:""}),l.label&&t.jsx("div",{className:"obj-label",children:l.label})]}),w&&a&&(()=>{const m=se(a),X=String(m.status||"empty"),R=j&&String(j)===String(a.id);return t.jsxs("div",{className:`table floor-table status-${X} ${String(a.shape||"square")} ${R?"is-selected":""}`,onClick:()=>v==null?void 0:v(a.id),style:{position:"absolute",top:0,left:0,width:`${Y(a.spanX)}px`,height:`${Y(a.spanY)}px`,cursor:i==="view"?"pointer":"default"},children:[t.jsx("div",{className:"fe-table-visual","data-asset":a.assetFile||"",children:t.jsx("img",{className:`fe-asset fe-asset--${(a.assetFile||"").replace(/[^a-z0-9]+/gi,"_").toLowerCase()}`,style:{transform:`rotate(${ce(a.rotationDeg??a.rotation??0)}deg) scale(${le(a.scale,1)})`},src:a.assetFile?`${h}${a.assetFile}`:ge(a.shape,a.seats),alt:""})}),t.jsxs("div",{className:"fe-table-overlay",children:[t.jsx("div",{className:"table-label",children:a.name||(a.tableNumber!=null?`Table ${a.tableNumber}`:"Table")}),a.seats!=null&&t.jsxs("div",{className:"table-seats",children:[a.seats," seats"]})]})]})})()]},s)}),i==="view"&&D.length>0&&t.jsx("div",{className:"sbv-status-layer",style:{position:"absolute",inset:0,zIndex:999,pointerEvents:"none"},children:D})]})]})}function we(r){const i=(r||"").toLowerCase();return i==="occupied"||i==="busy"||i==="taken"?"occupied":i==="reserved"||i==="booked"?"reserved":i==="dirty"||i==="needs_cleaning"?"dirty":"empty"}function J(r){return c(`floor.status.${r}`,r)}function je({restaurantId:r,mountMode:i="page"}){const[v,j]=x.useState([]),[k,O]=x.useState(null),[_,W]=x.useState(null),[I,E]=x.useState(!0),[G,H]=x.useState(null),[M,S]=x.useState(null),[L,$]=x.useState([]),[A,P]=x.useState(null),C=typeof document<"u"?document.getElementById("sb-floor-root"):null,z=String((C==null?void 0:C.getAttribute("data-click-mode"))||(C==null?void 0:C.getAttribute("data-mode"))||(i==="lobby"?"lobby":"page")).toLowerCase();x.useEffect(()=>{(async()=>{try{const e=await fetch(`/api/floor-sections/${r}`);if(!e.ok)return;const s=await e.json(),n=Array.isArray(s)?s:(s==null?void 0:s.sections)??[];n.sort((o,a)=>(o.displayOrder??0)-(a.displayOrder??0)),$(n)}catch{}})()},[r]);const T=x.useCallback(async()=>{try{const e=await fetch(`/api/floor-layouts/${r}/active`,{headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP ${e.status}`);const s=await e.json(),n=s&&s.id?s:(s==null?void 0:s.activeLayout)??null;if(!n){j([]),O(null),W(null),H(c("host.no_floor_plan","No active floor plan")),E(!1);return}j([n]),O(n.id),W(o=>o??n.id),H(null),E(!1),M&&((n.tables||[]).some(a=>String(a.id)===String(M))||S(null))}catch(e){H(c("host.err_load_map","Error loading floor map")+`: ${(e==null?void 0:e.message)??"unknown"}`),E(!1)}},[r,M]);x.useEffect(()=>{T();const e=setInterval(T,5e3);return()=>clearInterval(e)},[T]);const p=x.useMemo(()=>_?v.find(e=>e.id===_)??null:null,[v,_]),Z=x.useMemo(()=>p?A?{...p,tables:(p.tables||[]).filter(e=>e.sectionId===A)}:p:null,[p,A]),b=x.useMemo(()=>!p||!M?null:(p.tables||[]).find(e=>String(e.id)===String(M))??null,[p,M]),d=x.useMemo(()=>{if(!p||!b)return null;const e=p.tableStatuses;if(!Array.isArray(e))return null;const s=e.find(o=>String(o.tableId)===String(b.id));if(s)return s;const n=(b==null?void 0:b.tableNumber)??(b==null?void 0:b.number);return e.find(o=>o.tableNumber===n)??null},[p,b]),F=x.useMemo(()=>we(d==null?void 0:d.status),[d]),re=x.useCallback(e=>{S(e);try{const s=typeof document<"u"?document.getElementById("sb-floor-root"):null,n=((p==null?void 0:p.tables)||[]).find(a=>String(a.id)===String(e)),o=(n==null?void 0:n.tableNumber)??(n==null?void 0:n.number)??null;s&&s.dataset&&(s.dataset.selectedTableId=String(e),s.dataset.selectedTableNumber=o!=null?String(o):""),window.dispatchEvent(new CustomEvent("sb-floor-selection",{detail:{tableIds:[String(e)],tableNumbers:o!=null?[Number(o)]:[]}}))}catch{}},[p]),Q=()=>S(null),Y=async e=>{const s=b==null?void 0:b.id;if(s)try{const n=await fetch(`/api/tables/${r}/${s}/status?status=${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})});if(!n.ok){const o=await n.text().catch(()=>"");throw new Error(o||`HTTP ${n.status}`)}await T()}catch(n){console.error("Failed to update table status:",n)}},ee=async()=>{await Y("dirty")},ae=async()=>{await Y("empty")},oe=async()=>{await Y("reserved")},se=async()=>{await Y("empty")},D=`floor-editor sb-floor-view ${i==="lobby"?"is-embed":""}`;return I?t.jsx("div",{className:D,children:t.jsx("div",{className:"sbv-loading",children:c("floor.loading","Loading floor plan...")})}):G||!p?t.jsx("div",{className:D,children:t.jsxs("div",{className:"sbv-error",children:[t.jsx("div",{className:"sbv-error-title",children:c("host.err_load_map","Cannot load floor map")}),t.jsx("div",{className:"sbv-error-sub",children:G??c("host.err_load_map","Error loading floor map")}),t.jsx("button",{className:"sbv-retry",onClick:T,children:c("common.btn_refresh","Retry")})]})}):t.jsx("div",{className:D,children:t.jsxs("div",{className:"sbv-shell",children:[t.jsxs("div",{className:"sbv-left",children:[t.jsxs("div",{className:"layout-tabs-bar sbv-view-topbar",children:[t.jsxs("div",{className:"sbv-topbar-left",children:[t.jsx("div",{className:"sbv-topbar-title",children:c("host.floor_map_title","Restaurant Map (Live)")}),t.jsx("div",{className:"sbv-topbar-sub",children:c("floor.hints.controls","Drag to pan, Ctrl+wheel to zoom")})]}),t.jsxs("div",{className:"sbv-legend","aria-label":"Legend",children:[t.jsxs("span",{className:"sbv-pill is-empty",children:[t.jsx("span",{className:"sbv-dot"})," ",J("empty")]}),t.jsxs("span",{className:"sbv-pill is-occupied",children:[t.jsx("span",{className:"sbv-dot"})," ",J("occupied")]}),t.jsxs("span",{className:"sbv-pill is-reserved",children:[t.jsx("span",{className:"sbv-dot"})," ",J("reserved")]}),t.jsxs("span",{className:"sbv-pill is-dirty",children:[t.jsx("span",{className:"sbv-dot"})," ",J("dirty")]})]}),L.length>1&&t.jsxs("div",{className:"sbv-section-tabs",role:"tablist","aria-label":c("floor.sections.title","Sections"),children:[t.jsx("button",{className:`sbv-section-tab ${A===null?"is-active":""}`,onClick:()=>P(null),role:"tab","aria-selected":A===null,children:c("common.all","All")}),L.map(e=>t.jsx("button",{className:`sbv-section-tab ${A===e.id?"is-active":""}`,onClick:()=>P(e.id),role:"tab","aria-selected":A===e.id,children:e.name},e.id))]})]}),t.jsx("div",{className:"editor-content sbv-editor-content",children:t.jsx(Ne,{layout:Z,selectedTableId:M,onTableClick:re,mode:"view"})})]}),t.jsx("aside",{className:`sbv-right ${i==="lobby"&&M?"open":""}`,"aria-label":c("host.table_details","Table details"),children:M?t.jsxs("div",{className:"sbv-right-panel",role:"dialog","aria-modal":"false",children:[t.jsxs("div",{className:"sbv-drawer-header",children:[t.jsx("div",{className:"sbv-drawer-title",children:c("host.table_details","Table Details")}),t.jsx("button",{className:"sbv-close",onClick:Q,"aria-label":c("common.btn_close","Close"),children:"✕"})]}),t.jsxs("div",{className:"sbv-drawer-body",children:[t.jsxs("div",{className:"sbv-table-number",children:[c("host.table_label","Table")," ",(b==null?void 0:b.tableNumber)??(b==null?void 0:b.number)??"—"]}),t.jsxs("div",{className:`sbv-status-row is-${F}`,children:[t.jsx("span",{className:"sbv-status-dot"}),t.jsx("span",{className:"sbv-status-label",children:c("host.table_status_label","Table Status")}),t.jsx("span",{className:"sbv-status-value",children:J(F)})]}),t.jsxs("div",{className:"sbv-kv",children:[t.jsxs("div",{className:"sbv-kv-row",children:[t.jsx("div",{className:"sbv-kv-key",children:c("host.guest_name","Guest Name")}),t.jsx("div",{className:"sbv-kv-val",children:(d==null?void 0:d.guestName)??"—"})]}),t.jsxs("div",{className:"sbv-kv-row",children:[t.jsx("div",{className:"sbv-kv-key",children:c("host.num_guests","Guests")}),t.jsx("div",{className:"sbv-kv-val",children:(d==null?void 0:d.guestCount)!=null?String(d.guestCount):"—"})]}),t.jsxs("div",{className:"sbv-kv-row",children:[t.jsx("div",{className:"sbv-kv-key",children:c("host.reservation_time","Reservation Time")}),t.jsx("div",{className:"sbv-kv-val",children:(d==null?void 0:d.reservationTime)??"—"})]}),t.jsxs("div",{className:"sbv-kv-row",children:[t.jsx("div",{className:"sbv-kv-key",children:c("pos.waiter.items_label","Items")}),t.jsx("div",{className:"sbv-kv-val",children:(d==null?void 0:d.itemsCount)??"—"})]}),t.jsxs("div",{className:"sbv-kv-row",children:[t.jsx("div",{className:"sbv-kv-key",children:c("pos.waiter.subtotal","Subtotal")}),t.jsx("div",{className:"sbv-kv-val",children:(d==null?void 0:d.subtotal)??"—"})]})]})]}),t.jsxs("div",{className:"sbv-drawer-footer",children:[z==="lobby"||z==="waiter"?t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"sbv-secondary-btn",onClick:ee,disabled:F==="dirty",children:c("floor.mark_dirty","Mark Dirty")}),t.jsx("button",{className:"sbv-success-btn",onClick:ae,disabled:F!=="dirty",children:c("floor.mark_clean","Mark Clean")})]}):null,z==="host"?t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"sbv-primary-btn",onClick:oe,disabled:F==="reserved",children:c("floor.mark_reserved","Mark Reserved")}),t.jsx("button",{className:"sbv-secondary-btn",onClick:se,disabled:F==="empty",children:c("floor.mark_empty","Mark Empty")})]}):null,F==="occupied"&&(d!=null&&d.orderId)&&(b!=null&&b.number)?t.jsx("a",{className:"sbv-primary-btn",href:`/waiter/${r}/${b.number}`,children:c("pos.waiter.btn_open_order","Open Order")}):null,t.jsx("button",{className:"sbv-secondary-btn",onClick:Q,children:c("common.btn_close","Close")})]})]}):t.jsxs("div",{className:"sbv-right-empty",children:[t.jsx("div",{className:"sbv-right-empty-title",children:c("host.table_details","Table Details")}),t.jsx("div",{className:"sbv-right-empty-sub",children:c("host.floor_map_help","Select a table on the map to view details.")})]})})]})})}const U=document.getElementById("sb-floor-root");if(!U)throw new Error("Missing #sb-floor-root");const de=U.getAttribute("data-rid")||U.getAttribute("data-restaurant-id")||"",ie=U.getAttribute("data-click-mode")||U.getAttribute("data-mode")||"page",ue=ie==="lobby"||ie==="host"?"lobby":"page";console.info("[FloorView] mount",{rid:de,mountMode:ue,clickMode:ie});pe.createRoot(U).render(t.jsx(x.StrictMode,{children:t.jsx(je,{restaurantId:de,mountMode:ue})}));
